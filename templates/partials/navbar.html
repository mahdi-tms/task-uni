{% load static %}
<header class="fixed top-0 inset-x-0 z-40">
  <div class="bg-white/90 glass border-b border-slate-100 shadow-sm">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex h-16 items-center justify-between gap-4">
        <div class="flex items-center gap-3">
          <button id="mobile-menu-toggle" class="lg:hidden inline-flex items-center justify-center w-10 h-10 rounded-lg border border-slate-200 text-slate-600 hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-brand-500" aria-label="منوی موبایل">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6" d="M4 6h16M4 12h16M4 18h16"/></svg>
          </button>
          <a href="/" class="flex items-center gap-2 font-semibold text-xl text-slate-900">
            <span class="w-10 h-10 rounded-xl bg-gradient-to-tr from-brand-500 to-emerald-400 grid place-items-center text-white shadow-soft">E</span>
            <span>اِلاته</span>
          </a>
        </div>

        <form action="{% url 'shop:product_list' %}" method="get" class="hidden lg:flex flex-1 max-w-2xl">
          <label class="relative w-full">
            <input name="q" value="{{ request.GET.q }}" type="search" placeholder="جستجو در محصولات..." class="w-full rounded-xl border border-slate-200 bg-slate-50/60 px-4 py-3 pe-11 text-sm focus:border-brand-500 focus:ring-2 focus:ring-brand-200 transition">
            <button class="absolute inset-y-0 start-0 flex items-center ps-3 text-slate-500" aria-label="جستجو">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="m21 21-4.35-4.35M11 18a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"/></svg>
            </button>
          </label>
        </form>

        <div class="flex items-center gap-2">
          <a href="{% url 'shop:product_list' %}" class="hidden lg:inline-flex px-3 py-2 text-sm font-medium text-slate-700 hover:text-brand-600">فروشگاه</a>
          {% if user.is_authenticated %}
            <div class="relative">
              <button id="account-toggle" class="inline-flex items-center gap-2 px-3 py-2 rounded-lg bg-slate-100 text-sm font-medium text-slate-700 hover:bg-slate-200 focus:outline-none focus:ring-2 focus:ring-brand-400">
                <span>{{ user.get_short_name|default:user.username }}</span>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="m6 9 6 6 6-6"/></svg>
              </button>
              <div id="account-menu" class="hidden absolute end-0 mt-2 w-44 rounded-xl border border-slate-100 bg-white shadow-lg py-2 text-sm">
                <a href="{% url 'shop:checkout' %}" class="block px-3 py-2 hover:bg-slate-50">سفارش جدید</a>
                <a href="{% url 'shop:logout' %}" class="block px-3 py-2 hover:bg-slate-50">خروج</a>
              </div>
            </div>
          {% else %}
            <a href="{% url 'shop:login' %}" class="px-3 py-2 text-sm font-medium text-slate-700 hover:text-brand-600">ورود</a>
            <a href="{% url 'shop:register' %}" class="hidden sm:inline-flex px-3 py-2 rounded-lg bg-gradient-to-l from-brand-500 to-emerald-500 text-white text-sm font-semibold shadow-soft hover:translate-y-[-1px] transition">عضویت</a>
          {% endif %}
          <a href="{% url 'shop:cart' %}" class="relative inline-flex items-center justify-center w-11 h-11 rounded-xl bg-slate-900 text-white hover:bg-slate-800 transition" aria-label="سبد خرید">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6" d="M3 5h2l1 12h12l1.5-9H6.5M9 21a.75.75 0 1 1-1.5 0A.75.75 0 0 1 9 21Zm10 0a.75.75 0 1 1-1.5 0A.75.75 0 0 1 19 21Z"/></svg>
            {% if cart_count %}
              <span class="absolute -top-1 -end-1 bg-emerald-400 text-slate-900 text-[11px] font-semibold px-2 py-0.5 rounded-full">{{ cart_count }}</span>
            {% endif %}
          </a>
        </div>
      </div>
    </div>

    <div id="mobile-menu" class="lg:hidden hidden border-t border-slate-100 bg-white/95 glass">
      <div class="max-w-7xl mx-auto px-4 py-4 space-y-3 text-sm">
        <form action="{% url 'shop:product_list' %}" method="get" class="relative">
          <input name="q" value="{{ request.GET.q }}" type="search" placeholder="جستجوی محصولات" class="w-full rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 focus:border-brand-500 focus:ring-2 focus:ring-brand-200">
          <button class="absolute inset-y-0 start-0 flex items-center ps-3 text-slate-500" aria-label="جستجو">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="m21 21-4.35-4.35M11 18a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"/></svg>
          </button>
        </form>
        <a href="/" class="block px-3 py-2 rounded-lg bg-slate-50 hover:bg-slate-100">خانه</a>
        <a href="{% url 'shop:product_list' %}" class="block px-3 py-2 rounded-lg bg-slate-50 hover:bg-slate-100">فروشگاه</a>
        {% if user.is_authenticated %}
          <a href="{% url 'shop:checkout' %}" class="block px-3 py-2 rounded-lg bg-slate-50 hover:bg-slate-100">تسویه حساب</a>
          <a href="{% url 'shop:logout' %}" class="block px-3 py-2 rounded-lg bg-slate-50 hover:bg-slate-100">خروج</a>
        {% else %}
          <a href="{% url 'shop:login' %}" class="block px-3 py-2 rounded-lg bg-slate-50 hover:bg-slate-100">ورود</a>
          <a href="{% url 'shop:register' %}" class="block px-3 py-2 rounded-lg bg-slate-50 hover:bg-slate-100">ثبت‌نام</a>
        {% endif %}
      </div>
    </div>
  </div>
</header>
